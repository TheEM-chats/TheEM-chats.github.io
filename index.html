<!DOCTYPE html>
<html lang="ru">
<link rel="manifest" href="/manifest.json">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
    html,
    body {
        overflow: hidden;
        margin: 0;
        padding: 0;
    }
</style>

<head>
    <meta charset="UTF-8" />
    <title>TheEM - –í—Ö–æ–¥ –∏ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</title>
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É p5.js –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ p5.dom -->

    <script src="libs/p5.js?v2"></script>
    <script src="libs/xlibs.js?v2"></script>
    <script src="index/log.js?v2"></script>
    <script src="index/reg.js?v2"></script>
</head>

<body>
    <script>
        var isReg = true
        var btnx
        var btny
        var btnanim
        var last_captcha
        let Zframe
            // –í—Å—Ç–∞–≤–ª—è–µ–º CSS —á–µ—Ä–µ–∑ JavaScript
        let lgnstyle = document.createElement('style');
        lgnstyle.innerHTML = `
    input::placeholder {
      color: var(--placeholder-color);
      font-weight: bold;
      opacity: 1; /* –¥–µ–ª–∞–µ–º –µ–≥–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤–∏–¥–∏–º—ã–º */
    }
  `;
        document.head.appendChild(lgnstyle);

        function hasInvalidCharacters(text) {
            // –†–∞–∑—Ä–µ—à–µ–Ω—ã: –ª–∞—Ç–∏–Ω–∏—Ü–∞, –∫–∏—Ä–∏–ª–ª–∏—Ü–∞, —Ü–∏—Ñ—Ä—ã, –ø—Ä–æ–±–µ–ª, @ –∏ .
            const regex = /^[a-zA-Z–∞-—è–ê-–Ø—ë–Å0-9@. ]+$/;
            return !regex.test(text);
        }

        function setup() {

            if (getCookie("IsReg") == "1") {
                window.location.href = "homepage.html";
            }

            setInterval(() => {
                if (getCookie("captcha") == "no") {
                    captcha.checked(true)
                    try {
                        Zframe.remove()
                    } catch {

                    }
                } else {
                    captcha.checked(false)
                }
                if (!isReg) {
                    captcha.hide()
                    btndo.position((window.innerWidth - 342) / 2, (window.innerHeight + 50) / 2)
                    btndo.size(340, 70)
                } else {
                    captcha.show()
                    btndo.position((window.innerWidth - 342) / 2, (window.innerHeight + 100) / 2)
                    btndo.size(340, 46)
                }
                last_captcha = captcha.checked()
                console.log("–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ!");
                if (btnanim != "n") {
                    updatepos()
                }
            }, 250);

            function updatepos() {
                regbord.position((window.innerWidth - 342) / 2, (window.innerHeight - 194) / 2)
                logbord.position((window.innerWidth) / 2, (window.innerHeight - 194) / 2)
                lgn.position((window.innerWidth - 342) / 2, (window.innerHeight - 114) / 2)
                lgnp.position((window.innerWidth - 342) / 2, (window.innerHeight - 134) / 2)
                pss.position((window.innerWidth - 342) / 2, (window.innerHeight - 31) / 2)
                pssp.position((window.innerWidth - 342) / 2, (window.innerHeight - 51) / 2)
                btndo.position((window.innerWidth - 342) / 2, (window.innerHeight + 100) / 2)
                captcha.position((window.innerWidth - 342) / 2, (window.innerHeight + 50) / 2)
                fsimg.position((window.innerWidth - 128) / 2, (window.innerHeight - 480) / 2)
                if (isReg) {
                    btnx = (window.innerWidth - 342) / 2
                    btny = (window.innerHeight - 194) / 2
                } else {
                    btnx = (window.innerWidth) / 2
                    btny = (window.innerHeight - 194) / 2
                }

                btnanim = "n"
                btn.position(btnx, btny)
            }
            window.addEventListener("resize", () => {
                updatepos()
            });
            noCanvas();
            BackStyling()
            let btn = createButton('')
            ButtonStyling(btn)
            btn.size(170, 35)
            btn.style('border-radius', '8px')
            btn.style('z-index', '-1')
            btn.style('position', 'absolute')
            btn.style('background', 'rgba(255, 80, 80, 0.3)')
            btn.style('box-shadow', '0 2px 6px rgba(150, 0, 0, 0.2)')

            btn.mouseOver(() => {
                btn.style('background', 'rgba(255, 100, 100, 0.45)')
                btn.style('box-shadow', '0 3px 10px rgba(150, 0, 0, 0.35)')
            });

            btn.mouseOut(() => {
                btn.style('background', 'rgba(255, 80, 80, 0.3)')
                btn.style('box-shadow', '0 2px 6px rgba(150, 0, 0, 0.2)')
            });

            btn.mouseOver(() => {});
            btn.mouseOut(() => {});
            btn.style('cursor', 'default')
                //–ì–ª–∞–≤–Ω—ã–π –±–æ—Ä—å–µ—Ä
            mainbord = createButton("")
            mainbord.style('background', 'transparent');
            mainbord.size(356, 200)
            mainbord.style('border-radius', '5px')
            mainbord.style('border', '2px solid #bbbbbb');
            //–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
            regbord = createButton("–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è")
            regbord.style('color', '#ffffff');
            regbord.style('background', 'transparent');
            regbord.size(170, 35)
            regbord.style('border-radius', '5px')
            regbord.style('border', '2px solid #bbbbbb');
            regbord.mousePressed(() => {
                btnanim = "-"
                isReg = true
            });
            //–õ–æ–≥–∏–Ω
            logbord = createButton("–í—Ö–æ–¥")
            logbord.style('color', '#ffffff');
            logbord.style('background', 'transparent');
            logbord.size(170, 35)
            logbord.style('border-radius', '5px')
            logbord.style('border', '2px solid #bbbbbb');
            logbord.mousePressed(() => {
                btnanim = "+"
                isReg = false
            });
            //–ù–∏–∫ - –ª–æ–≥–∏–Ω
            lgn = createInput("")
            lgn.attribute('placeholder', '–í–∞—à –ª–æ–≥–∏–Ω(–∫–∞–∫ –Ω–∏–∫ –Ω–æ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è):');
            lgn.elt.style.setProperty('--placeholder-color', '#cccccc')
            lgn.size(318, 35)
            lgn.style('padding-left', '20px')
            ButtonStyling(lgn)
            lgn.style('border-radius', '10px')
            lgnp = createP("üë§")
                //–ü–∞—Ä–æ–ª—å
            pss = createInput("")
            pss.attribute('placeholder', '–í–∞—à –ø–∞—Ä–æ–ª—å:');
            pss.elt.style.setProperty('--placeholder-color', '#cccccc')
            pss.size(318, 35)
            pss.style('padding-left', '20px')
            ButtonStyling(pss)
            pss.style('border-radius', '10px')
            pssp = createP("üîë")
                //–ö–Ω–æ–ø–æ—á–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è
            let btndo = createButton('–î–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å!')
            ButtonStyling(btndo)
            btndo.size(340, 46)
            btndo.style('border-radius', '8px')
            btndo.style('background', 'rgba(100, 200, 150, 0.18)');
            btndo.style('box-shadow', '0 2px 6px rgba(0, 100, 50, 0.15)');

            btndo.mouseOver(() => {
                btndo.style('background', 'rgba(120, 220, 170, 0.25)');
                btndo.style('box-shadow', '0 3px 10px rgba(0, 100, 50, 0.25)');
            });

            btndo.mouseOut(() => {
                btndo.style('background', 'rgba(100, 200, 150, 0.18)');
                btndo.style('box-shadow', '0 2px 6px rgba(0, 100, 50, 0.15)');
            });
            btndo.mousePressed(() => {
                if (lgn.value() != "" && pss.value() != "") {
                    if (!hasInvalidCharacters(lgn.value()) && !hasInvalidCharacters(pss.value())) {
                        if (isReg) {
                            if (captcha.checked()) {
                                console.log("–†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º")
                                reg_func(lgn.value(), pss.value())
                            } else {
                                xAlert("–°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–π–¥–∏—Ç–µ –∫–∞–ø—Ç—á—É!!!")
                            }
                        } else {
                            console.log("–í—Ö–æ–¥–∏–º")
                            log_func(lgn.value(), pss.value())
                        }
                    } else {
                        xAlert("–í –ø–∞—Ä–æ–ª–µ –∏ –ª–æ–≥–∏–Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ (–ø—Ä–æ–±–µ–ª)(–±—É–∫–≤—ã)(—Ü–∏—Ñ—Ä—ã)(@ –∏ .)")
                    }
                } else {
                    xAlert("–õ–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—É—Å—Ç—ã–º–∏!")

                }
            });
            //–ö–∞–ø—Ç—á–∞
            captcha = createCheckbox('–ö–∞–ø—Ç—á–∞„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§', false);
            ButtonStyling(captcha)
            captcha.changed(handleChange);
            captcha.size(340, 22)
            captcha.style('cursor', 'default')
            captcha.mouseOver(() => {});
            captcha.mouseOut(() => {});
            setCookie2("captcha", "idk")

            //–ò–∫–æ–Ω–∫–∞
            let fsimg = createButton('');
            fsimg.style('z-index', '101');
            fsimg.size(128, 128)
            fsimg.position(0, 0)
            ButtonStyling(fsimg)
            fsimg.style('background-image', 'url("ico2.jpg")')
            fsimg.style('background-size', 'cover');
            fsimg.style('border-radius', '15px')
            fsimg.mouseOver(() => {});
            fsimg.mouseOut(() => {});
            //–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ
            updatepos()


        }

        function handleChange() {
            console.log("–ö–∞–ø—Ç—á–∞ –Ω–∞–∂–∞—Ç–∞!");
            setTimeout(() => {
                Zframe = createElement('iframe');
                Zframe.attribute('src', 'captcha.html');
                Zframe.size(window.innerWidth - 100, window.innerHeight - 100);
                Zframe.position(50, 50);
                Zframe.style('z-index', '9999');
                Zframe.style('position', 'absolute');
                Zframe.style('border-radius', '10px');
                Zframe.style('pointer-events', 'auto');
                Zframe.parent(document.body);
                Zframe.elt.focus();
            }, 100); // 100 –º—Å –∑–∞–¥–µ—Ä–∂–∫–∞

        }
    </script>
    <script>
        if (typeof navigator.serviceWorker !== 'undefined') {
            navigator.serviceWorker.register('webpushr-sw.js')
        }
    </script>

</body>

</html>