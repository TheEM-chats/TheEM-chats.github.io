<!DOCTYPE html>
<html lang="ru">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
    html,
    body {
        overflow: hidden;
        margin: 0;
        padding: 0;
    }
</style>

<head>
    <meta charset="UTF-8" />
    <title>TheEM - безопасный интернет</title>
    <!-- Подключаем библиотеку p5.js и расширение p5.dom -->

    <script src="libs/p5.js"></script>
    <script src="libs/xlibs.js"></script>
</head>

<body>
    <script>
        let frame;

        function setup() {
            noCanvas(); // отключаем холст, если он не нужен
            window.addEventListener("resize", () => {
                frame.size(window.innerWidth, window.innerHeight)
            });

            function normalizeUrl(url) {
                if (!/^https?:\/\//i.test(url)) {
                    url = 'https://' + url;
                }
                return url;
            }

            function gourl(url) {
                input.value(url)
                url = normalizeUrl(url)
                try {
                    frame.remove()
                } catch {
                    console.log("Не найдено!")
                }
                frame = createElement('iframe');
                frame.attribute('src', url);
                frame.attribute('sandbox', 'allow-scripts');
                frame.position(1, 55)
                frame.size(window.innerWidth, window.innerHeight)


            }
            let input = createInput()
            input.attribute('placeholder', 'Введите url');
            input.style('font-size', '12px');
            input.elt.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    console.log('Enter нажат: ' + input.value());
                    gourl(input.value())

                }
            });
            input.position(90, 0)
            input.size(window.innerWidth - 170, 15)
            let send = createButton("Перейти")
            send.mousePressed(() => {
                gourl(input.value())
            });
            send.position(window.innerWidth - 80, 0)
            gourl(getCookie("safeurl"))
            let ext = createButton("Назад")
            ext.size(90, 20)
            ext.position(0, 0)
            ext.mousePressed(() => {
                window.location.href = "chat.html"
            });
            let opn = createButton("Открыть так")
            opn.position(0, 20)
            opn.mousePressed(() => {
                window.location.href = input.value()
            });
            let tip = createP("Если не загружается, нажмите `Открыть так`, но лучше этого не делать")
            tip.position(90, 5)
        }
    </script>
</body>

</html>